{"ast":null,"code":"import cookie from \"cookie\";\n\nvar checkLogin = function checkLogin(req, res) {\n  if (req != undefined) {\n    if (req.headers != undefined) {\n      if (req.headers.cookie != undefined && req.headers.cookie != null) {\n        var cookies = cookie.parse(req.headers.cookie);\n\n        if (cookies.id) {\n          return {\n            loggedIn: true,\n            id: cookies.id\n          };\n        } else {\n          if (res) {\n            res.writeHead(302, {\n              Location: \"/login\"\n            });\n            res.end();\n          }\n        }\n      }\n    }\n  }\n\n  return {\n    loggedIn: false,\n    id: null\n  };\n};\n\nexport default checkLogin;","map":null,"metadata":{},"sourceType":"module"}